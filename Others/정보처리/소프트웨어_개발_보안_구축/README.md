# Secure SDLC (Software Development Life Cycle)

- SDLC의 보안 강화를 위한 프로세스를 포한시키는 것

- 대표적 방법론
  1. CLASP
     - SDLC `초기 단계`에서 보안 강화를 위해 개발된 방법론
  1. SDL
     - MS에서 안전한 SW 개발을 위해 `기존의 SDLC`를 `개선`한 방법론
  1. Sven Touchpoints
     - SW `보안 모범사례`를 SDLC에 `통합`한 방법론

## 보안 활동

1. 요구사항 분석 단계
   - 요구사항 식별
1. 설계 단계
   - 보안 설계서 작성
1. 구현 단계
   - 설계서에 따라 보안 요구사항 구현
1. 테스트 단계
1. 유지보수 단계

## 보안 요소

1. 기밀성
   - `인가된 사용자만 접근 허용`
   - 데이터가 `노출`되더라도 `데이터를 읽을 수 없다`.
1. 무결성
   - 시스템 내의 정보는 `인가된 사용자만 사용가능`
1. 가용성
   - `인가받은 사용자`면 `언제든지 정보 및 자원 사용`가능
1. 인증
   - 사용자가 합법적 사용자인지 확인하는 모든 과정
     - 패스워드 , 지문검사 .. 등
1. 부인방지
   - 송수신자가 부인할 수 없도록 `송/수신 증거`를 제공

## 시큐어 코딩

`보안 요소들을 고려하며 코딩하는 것`

- 보안 취약점을 사전 대응하여 안전성&신뢰성 확보

# 세션 동제

`세션의 연결 및 연결로 인해 방행하는 정보를 관리하는 것`

- 보안 약점
  1.  불충분한 세션 관리
      - 규칙이 있는 세션ID 및 타임아웃이 너무 길면 발생할 수 있다.
  2.  잘못된 세션에 의한 정보 노출
      - 다중 스레드 환경에서 멤버 변수 정보를 저장시 발생

## 설계시 고려사항

- 모든 페이지에서 로그아웃이 가능하도록 UI설계한다.
- 로그아웃시 할당된 세션이 완전히 제거되야한다
- 타임아웃은 중요도가 `높으면 2~5분`, `낮으면 15~30분`
- 이전 세션이 종료되야 세션이 생성되지 못 해야한다
- 중복 로그인을 허용하지 않으면 클라이언트 중복 접근에 대한 세션 관리 정책을 수립한다.

## 세션 ID 관리 방법

- 안전한 서버에서 최소 128bit의 길이로 한다
- 예측 불가하도록 난수 알고리즘을 적용한다
- 노출되지 않도록 URL Rewrite기능을 사용하지 않는 방식으로 설계한다.
  - 쿠키를 사용하지 못 하는 상황에서 `세션ID`를 `URL에 포함`시키는 것
- 로그인시 이전 `세션ID`를 `삭제 및 재할`당한다
- 장기간 접속중인 `세션ID`는 주기적으로 재할당한다

# 입력 데이터 검증 및 표현

`입력 데이터`로 인해 발생하는 `문제를 예방`하기 위해 `구현 단계`에서 검증해야하는 `보안 점검 항목`

- 검증 및 표현의 보안 약점

  1.  SQL 삽입

      - SQL을 이용하여 DB 서버의 데이터 `유출 및 변조` 하고 `관리자 인증을 우회`하는 보안 약점
      - 동적 쿼리에 사용되는 입력 데이터에 `예약어 및 특수문자 필터링` 해야한다

  2.  경조 조작 및 자원 삽입
      - 입출력 경로를 조작하여 서버 자원 수정 및 삭제를 할 수 있는 약점
      - 입력값을 식별자로 사용할 경우, 경로 순회 공격을 막는 필터를 사용하여 방지
        - 경로 순회
          - `/`,`\`,`.` 등을 악욕하여 파일에 접근하는 방식
  3.  크로스사이트 스크립팅
      - 웹페이지에 스크립트를 삽입하여 `방문자 정보 탈취` 및 `비정상적 기능 수행`하는 약점
      - `html태그 제한` 및 `<`,`>`,`&`등을 다른 문자로 치환하여 방지
  4.  운영체제 명령어 삽입
      - 외부 입력값을 통해 시스템 명령어를 유도해 `권한`을 `탈취 및 장애 유발`을 야기
      - 웹 인터페으스를 통해 명령어 전달 방지하고, 검증 없이 내부 명령어로 사용 못 하게 칭환한다.
  5.  위험한 형식 파일 업로드
      - 명령어가 포함된 스크립트 `파일을 업로드`하여 시스템 `손상 및 시스템 제어`
      - `확장자 제한`, `암호화`, `웹사이트 및 파일서버 분리`, `실행 속성제거` 등으로 방지
  6.  신뢰되지 않은 URL 주소로 자동접속 연결
      - 입력 값을 URL로 조작하여 피싱 사이트로 유도
      - 외부 사이트 주소를 화이트 사이트로 관리하여 방지
  7.  하드코드된 암호화키
      - 암호키도 하크도드된 경우엔 역계산 가능하고, 무차별 대입(Broute Force)에 의해 탈취 당할 수 있다.
      - 상수 형태의 암호키를 사용하지 않고, 암호화 키 생성 모듈 혹은 보아ㅣㄴ이 보장된 외부 공간에 이동 하여 방지

# 시간 및 상세

- 시간 및 상태의 보안 약점
  1.  TOCTOU 경쟁 조건
      - `검사 시점` 및 `사용 시점`을 `고려하지 않고` 코딩한 경우
      - 코드 내 동기화 구문을 사용하여 한번에 `하나의 프로세스만 접근 가능`하도록 구현
  2.  종료되지 않은 반복문 또은 재귀함수
      - Loop문에서 종료 조건을 정의하지 않아 무한루프에 빠진 보안약점
      - 조건문으로 무한루프 방지

# 에러처리

- 보안 약점
  1.  오류 메시지를 통한 정보노출
      - 중요 정보는 메시지를 통해 외부에 노출되는 보안약점
      - 사전에 준비된 메시지만 출력하도록한다
  2.  오류 상황 대응 부재
      - 에러처리를 개발하지 않거나, 마비로 인해 생긴 보안약점
      - 에러처리 구문을 작성한다
  3.  부적절한 예외처리
      - 오류를 세분화하여 처리하지 않아 발생하는 보안약점
      - 오류 처리는 세분화 하여 예외처리를 수행한다

# 코드 오류

- 형변환 및 자원 반환 등의 오류를 예방하기 위한 보안 점검
- 보안 약점

  1.  NULL Pointer 역참조
      - NULL Pointer이 가리키는 메모리 위치에 값 저장시 발생
        - 포인터 사용전에 확인하여 예방
  2.  부적절한 자원 해제
      - 자원 반환 코드 누락 혹은 오류로 반환을 안 했을시 발생
        - 누락여부 확인 및 함수 종료시 예외처리에 관계없이 반환시킨다
  3.  해제된 자원 사용
      - 이미 반환된 메모리 사용시 발생
        - 반환된 메모리에 접근 불가하도록 주소 포인터를 초기화시킴
  4.  초기화 되지 않은 변수 사용

      - 선언 후 값이 부여되지 않은 변수 사용시 발생
        - 선언 시 할당된 메모리 초기화

## 스텍가드(Stack Guard)

- 주소가 저장되는 스택에서 발생하는 보안 점을 막는 기술
- 메모리 상에서 프로그램의 `복귀 주소 및 변수` 사이 특정 값을 저장 후 `값이 변경`되었을 때 `오버플로우로 판단`하여 프로그램 중단하여 `잘못된 복귀 주소 호출`을 막는다.

# 캡슐화

- 불완전 및 잘못 사용하는 것을 예박하기 위한 보안점검
- 보안 약점
  1. 잘못된 세션에 의한 정보 노출
     - `다중 스레드 환경`에서` 멘버변수 정보를 저장` 시 발생
     - `지역변수를 주로 사용`하여 변수 범윌를 제한함
  2. 제거되지 않고 남은 디버그 코드
     - `버그 수정 및 결과값 `확인을 위한 `코드가 남아있는경우 발생`
     - 배포 전에 확인하여 삭제
  3. 시스템 데이터 정보노출
     - 시스템 메시지를 통해 `외부로 출력`하도록 코딩시 발생
     - 노출 메시지는 최소화하여 방지
  4. public 메소드로 반환된 private배열
     - private 배열을 public 메소드에서 반환시 발생
     - 별도의 메소드 혹은 동일한 형태의 복제본으로 반환받은 후 값을 전달하는 방식으로 방지
  5. private배열에 public배열 할당
     - private배열에 public으로 선언된 데이터 혹은 파라미터를 저장시 발생
     - 선언된 데이터를 private 배열에 저장시 래퍼런스값이 아닌 값을 직접 저장하여 방지
       - 래퍼런스
         - 메모리의 위치를 공유한다

## 접근제어

- 외부 접근 제한을 위한 예약어
  |-|클래스 내부|패키지 외부|하위 클래스|패키지 외부|
  |-|- |-|-|-|
  |public|O|O|O|O|
  |protected|O|O|O|X|
  |Default|O|O|X|X|
  |privagte|O|X|X|X|

## API 오용

- 보안 약점
  1.  DNS Lokup에 의존한 보안 결정
      - 도메인명 의존 인증 및 접근 통제 등 보안 결정을 내리는 경우 발생
      - DNS 검색을 통해 도메인 이름을 비교하지 않고, IP주소를 직접 입력하여 방지
  1.  취약한 API 사용
      - 보안문제로 금지된 API사용 혹은 잘못된 방식으로 사용시 발생
      - 문제가 된 API는 함수로 대체하고, 메뉴얼을 통해 참조한다

# 암호 알고리즘

- 중요 정보를 보호하기 위해 평문을 암호 문장으로 만드는 절차 및 방법

## 분류

- 암호화 방식
  - 양방향
    - 개인키
      - `동일한 키`로 데이터를 암복호화 하는 기법
      - `대칭 암호/단일키 암호화` 기법이라고도 한다.
      - 암복호화 `속도가 빠르지만`, 관리해야할 `키가 많다`
      - 종류
        1. 스트림 암호화
           - 평문과 동일한 길이의 스트림 생성 후 `bit단위`로 암호화
             - LFSR,RC4
        2. 블록 암호화
           - `1번에 1개`의 데이터 블록 암호화
             - DES,SEED,AES,ARIA
             1. SEED
                - KISA에서 개발한 블록 암호화 알고리즘
                - `블록 크기 : 128bit` , `키 길이`에 따라 `128`,`256` 으로 분류
             1. ARIA ( Academy, Research Insitute, Agency)
                - 국가정보원 및 산학연협회가 개발한 블록 알고리즘
             1. DES( Data Encryption Standard)
                - NBS에서 발표한 `개인키 암호화 알고리즘`
                  - NIST(미국 표준 기술 연구소)의 과거이름
                - DES를 3번 적용한 3DES도 있다.
             1. AES(Advanced Encryption Standard)
                - 미국 표준 기술 연구소에서 발표한 개인키 알고리즘
                - DES의 한계를 느껴 공모한 후 발표
    - 공개키
      - 암호화시 공개키는 사용자에게 공개하고, 비밀키는 관리자만 관리하는 암호화 기법
      - `비대칭 엄호화 기법`이라고도 한다
      - 암복호화 `속도가 느리지만`, 관리해야할 `키가 적다`
      - 대표적으로 `RSA(Rivesat Shamir Adleman)` 기법이 있다.
        1. RSA( Rivest Shamir Adleman)
           - MIT의 라이베스트, 샤미르,에들면에 의해 제안된 공개키 알고리즘
           - 큰 숫자를 소인수분해 하기 어렵다는 것에 기반하여 만들어짐
  - 단방향
    - 해시(Hash)
      - 임의의 길이의 입력 데이터 혹은 메시지를 고넝된 길이의 값 혹은 키로 변환하는 것
      - 알고리즘 : `해시알고리즘`, 변환된 값 : `해시값 or 해시키라` 부름
      - 암호화, 무결성 검증 ,정보보호 등 많은 분야에서 사용된다.
      - 종류
        1.  sha시리즈
            - 미국 굴립표준기술연구소에서 발표
            - sha-0,1,2,224,256,384,512가 발표됨
        2.  MD5
            - `MD4를 대체`하기 위해 고안한암호화 해시 함수
            - `블록크기 : 512bit`, `키길이 : 128bit`
        3.  N-NASH
            - 일본의 전신전화주식회사에서 발표한 암호화 해시 함수
            - `블록 크기, 키길이 : 128bit`
        4.  SNEFRU
            - R.C.Merkle이 발표한 해시 함수
            - 32bit 프로세서에서 구현을 용이하게 할 목적으로 개발

# 서비스 공격 유형

## 서비스 거부 공격(DOS)

- 대량의 데이터를 한 곳의 서버에 집중 공격하여 서버의 장애를 발생시킴
- 유형
  1.  Ping of Death
      - 패킷의 크기를 인터넷 프로토콜 `허용 범위 이상 전송`하여 네트워크를 마비시키는 `DOS공격`
      - ICMP Ping 메시지에 응답 처리를 하느라 서버가 다운된다
        - ICMP Ping
          - 특정 IP의 `노드가 운영중`인지 `확인`할 떄 보내는 `패킷`
  2.  SMURFING
      - IP 혹은 ICMP의 특성을 약용하여 엄청난 양의 데이터를 한 사이트에 집중 적으로 보내 네트워크를 불능 상태로 만드는 방법
      - IP위장 후 네트워크 라우터의 브로드 캐스트 주소를 수신자로 하여 모든 네트워크에 패킷을 전송시킨다.
